<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>X509 (x509.X509)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">x509</a> &#x00BB; X509</nav><h1>Module <code>X509</code></h1><p>X509 encoding, generation, and validation.</p><p><code>X509</code> is a module for handling X.509 certificates and supplementary material (such as public and private RSA or EC keys), as described in <a href="https://tools.ietf.org/html/rfc5280">RFC 5280</a>. X.509 describes a hierarchical public key infrastructure, where all trust is delegated to certificate authorities (CA). The task of a CA is to sign certificate signing requests (CSR), which turns them into certificates, after verification that the requestor is eligible.</p><p>An X.509 certificate is an authentication token: a public key, a subject (e.g. server name), a validity period, optionally a purpose (usage), and various other optional <a href="Extension/index.html"><span>Extensions</span></a>. The overall approach of this package is to support decoding what is present in the real world, including weak ciphers (various validation functions support an allow list to avoid using weak hashes in chains if needed).</p><p>The public keys of trusted CAs are distributed with the software, or configured manually. When an endpoint connects, it presents its certificate chain, which are pairwise signed certificates. This chain is verified: the signatures have to be valid, the last certificate must be signed by a trusted CA, the name has to match the expected name, all certificates must be valid at the current time, and the purpose of each certificate must match its usage. An alternative validator checks that the hash of the server certificate matches the given hash.</p><p>This module uses the <code>result</code> type for errors. No provided binging raises an exception. Provided submodules include decoders and encoders (ASN.1 DER and PEM encoding) of X.509v3 <a href="Certificate/index.html"><span>certificates</span></a>, <a href="Distinguished_name/index.html"><span>distinguished names</span></a>, <a href="Public_key/index.html"><span>public keys</span></a> and <a href="Private_key/index.html"><span>private keys</span></a> (<a href="http://tools.ietf.org/html/rfc5208">PKCS 8, RFC 5208</a>), and <a href="Signing_request/index.html"><span>certificate signing requests</span></a> (<a href="http://tools.ietf.org/html/rfc2986">PKCS 10, RFC 2986</a>, both use parts of <a href="https://tools.ietf.org/html/rfc2985">PKCS 9, RFC 2985</a>), <a href="Validation/index.html"><span>certificate validation</span></a> by construction of <a href="Authenticator/index.html"><span>authenticators</span></a>. Name validation, as defined in <a href="https://tools.ietf.org/html/rfc6125">RFC 6125</a>, is also implemented.</p><p>The archive format for certificates and private keys, <a href="https://tools.ietf.org/html/rfc7292">PKCS 12, RFC 7292</a>, is implemented in the <a href="PKCS12/index.html"><code>PKCS12</code></a> submodule. While PKCS 12 decryption supports the weak algorithm used by default by widely used software (RC2!), the encryption path only supports AES.</p><p>Missing is the handling of online certificate status protocol. Some X.509v3 extensions are not handled, but only parsed, such as name constraints. If any extension is marked as critical in a certificate, but not handled, the validation will fail.</p><p><em>v0.13.0 - <a href="https://github.com/mirleft/ocaml-x509">homepage</a></em></p></header><dl><dt class="spec module" id="module-Host"><a href="#module-Host" class="anchor"></a><code><span class="keyword">module</span> <a href="Host/index.html">Host</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Hostnames (strict, wildcard), used for validation.</p></dd></dl><dl><dt class="spec module" id="module-Key_type"><a href="#module-Key_type" class="anchor"></a><code><span class="keyword">module</span> <a href="Key_type/index.html">Key_type</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Types of keys</p></dd></dl><dl><dt class="spec module" id="module-Public_key"><a href="#module-Public_key" class="anchor"></a><code><span class="keyword">module</span> <a href="Public_key/index.html">Public_key</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Public keys</p></dd></dl><dl><dt class="spec module" id="module-Private_key"><a href="#module-Private_key" class="anchor"></a><code><span class="keyword">module</span> <a href="Private_key/index.html">Private_key</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Private keys</p></dd></dl><dl><dt class="spec module" id="module-Distinguished_name"><a href="#module-Distinguished_name" class="anchor"></a><code><span class="keyword">module</span> <a href="Distinguished_name/index.html">Distinguished_name</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>X.500 distinguished name</p></dd></dl><dl><dt class="spec module" id="module-General_name"><a href="#module-General_name" class="anchor"></a><code><span class="keyword">module</span> <a href="General_name/index.html">General_name</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A list of <code>general_name</code>s is the value of both <a href="https://tools.ietf.org/html/rfc5280#section-4.2.1.6">subjectAltName</a> and <a href="https://tools.ietf.org/html/rfc5280#section-4.2.1.7">IssuerAltName</a> extension.</p></dd></dl><dl><dt class="spec module" id="module-Extension"><a href="#module-Extension" class="anchor"></a><code><span class="keyword">module</span> <a href="Extension/index.html">Extension</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>X.509v3 extensions</p></dd></dl><dl><dt class="spec module" id="module-Certificate"><a href="#module-Certificate" class="anchor"></a><code><span class="keyword">module</span> <a href="Certificate/index.html">Certificate</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>X509v3 certificate</p></dd></dl><dl><dt class="spec module" id="module-Validation"><a href="#module-Validation" class="anchor"></a><code><span class="keyword">module</span> <a href="Validation/index.html">Validation</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Chain Validation.</p></dd></dl><aside><p>Certificate Signing request</p></aside><dl><dt class="spec module" id="module-Signing_request"><a href="#module-Signing_request" class="anchor"></a><code><span class="keyword">module</span> <a href="Signing_request/index.html">Signing_request</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A certificate authority (CA) deals with <a href="https://tools.ietf.org/html/rfc2986">PKCS 10 certificate signing requests</a>, their construction and encoding, and provisioning using a private key to generate a certificate with a signature thereof.</p></dd></dl><dl><dt class="spec module" id="module-CRL"><a href="#module-CRL" class="anchor"></a><code><span class="keyword">module</span> <a href="CRL/index.html">CRL</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>X.509 Certificate Revocation Lists.</p></dd></dl><dl><dt class="spec module" id="module-Authenticator"><a href="#module-Authenticator" class="anchor"></a><code><span class="keyword">module</span> <a href="Authenticator/index.html">Authenticator</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Certificate chain authenticators</p></dd></dl><dl><dt class="spec module" id="module-PKCS12"><a href="#module-PKCS12" class="anchor"></a><code><span class="keyword">module</span> <a href="PKCS12/index.html">PKCS12</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>PKCS12 archive files</p></dd></dl></div></body></html>