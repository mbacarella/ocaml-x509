<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>X509__Validation (x509.X509__Validation)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">x509</a> &#x00BB; X509__Validation</nav><h1>Module <code>X509__Validation</code></h1></header><dl><dt class="spec value" id="val-sha2"><a href="#val-sha2" class="anchor"></a><code><span class="keyword">val</span> sha2 : <span><span>[&gt; `SHA256 <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></code></dt><dt class="spec value" id="val-all_hashes"><a href="#val-all_hashes" class="anchor"></a><code><span class="keyword">val</span> all_hashes : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></code></dt><dt class="spec value" id="val-src"><a href="#val-src" class="anchor"></a><code><span class="keyword">val</span> src : Logs.src</code></dt></dl><div class="spec module" id="module-Log"><a href="#module-Log" class="anchor"></a><code><span class="keyword">module</span> Log : Logs.LOG</code></div><dl><dt class="spec type" id="type-signature_error"><a href="#type-signature_error" class="anchor"></a><code><span class="keyword">type</span> signature_error</code> = <code>[ </code><table class="variant"><tr id="type-signature_error.Bad_signature" class="anchored"><td class="def constructor"><a href="#type-signature_error.Bad_signature" class="anchor"></a><code>| </code><code>`Bad_signature <span class="keyword">of</span> <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</code></td></tr><tr id="type-signature_error.Bad_encoding" class="anchored"><td class="def constructor"><a href="#type-signature_error.Bad_encoding" class="anchor"></a><code>| </code><code>`Bad_encoding <span class="keyword">of</span> <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string * Cstruct.t</code></td></tr><tr id="type-signature_error.Hash_not_allowed" class="anchored"><td class="def constructor"><a href="#type-signature_error.Hash_not_allowed" class="anchor"></a><code>| </code><code>`Hash_not_allowed <span class="keyword">of</span> <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * Mirage_crypto.Hash.hash</code></td></tr><tr id="type-signature_error.Unsupported_keytype" class="anchored"><td class="def constructor"><a href="#type-signature_error.Unsupported_keytype" class="anchor"></a><code>| </code><code>`Unsupported_keytype <span class="keyword">of</span> <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></code></td></tr><tr id="type-signature_error.Unsupported_algorithm" class="anchored"><td class="def constructor"><a href="#type-signature_error.Unsupported_algorithm" class="anchor"></a><code>| </code><code>`Unsupported_algorithm <span class="keyword">of</span> <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</code></td></tr><tr id="type-signature_error.Msg" class="anchored"><td class="def constructor"><a href="#type-signature_error.Msg" class="anchor"></a><code>| </code><code>`Msg <span class="keyword">of</span> string</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_signature_error"><a href="#val-pp_signature_error" class="anchor"></a><code><span class="keyword">val</span> pp_signature_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`Bad_encoding of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * string * Cstruct.t</span> <span><span>| `Bad_signature</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * string</span> <span><span>| `Hash_not_allowed</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * <span>[&lt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `Msg</span> of string</span> <span><span>| `Unsupported_algorithm</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * string</span> <span><span>| `Unsupported_keytype</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * <span>[ <span>`ED25519 of Mirage_crypto_ec.Ed25519.pub</span> <span><span>| `P224</span> of Mirage_crypto_ec.P224.Dsa.pub</span> <span><span>| `P256</span> of Mirage_crypto_ec.P256.Dsa.pub</span> <span><span>| `P384</span> of Mirage_crypto_ec.P384.Dsa.pub</span> <span><span>| `P521</span> of Mirage_crypto_ec.P521.Dsa.pub</span> <span><span>| `RSA</span> of Mirage_crypto_pk.Rsa.pub</span> ]</span></span> ]</span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-maybe_validate_hostname"><a href="#val-maybe_validate_hostname" class="anchor"></a><code><span class="keyword">val</span> maybe_validate_hostname : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span><span>[ `host ]</span> Domain_name.t</span> option</span> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-issuer_matches_subject"><a href="#val-issuer_matches_subject" class="anchor"></a><code><span class="keyword">val</span> issuer_matches_subject : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-is_self_signed"><a href="#val-is_self_signed" class="anchor"></a><code><span class="keyword">val</span> is_self_signed : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_raw_signature"><a href="#val-validate_raw_signature" class="anchor"></a><code><span class="keyword">val</span> validate_raw_signature : <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> <span>&#45;&gt;</span> <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <a href="../X509__/Algorithm/index.html#type-t">X509__.Algorithm.t</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <span>[ <span>`ED25519 of Mirage_crypto_ec.Ed25519.pub</span> <span><span>| `P224</span> of Mirage_crypto_ec.P224.Dsa.pub</span> <span><span>| `P256</span> of Mirage_crypto_ec.P256.Dsa.pub</span> <span><span>| `P384</span> of Mirage_crypto_ec.P384.Dsa.pub</span> <span><span>| `P521</span> of Mirage_crypto_ec.P521.Dsa.pub</span> <span><span>| `RSA</span> of Mirage_crypto_pk.Rsa.pub</span> ]</span> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`Bad_signature of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * string</span> <span><span>| `Hash_not_allowed</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `Unsupported_algorithm</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * string</span> <span><span>| `Unsupported_keytype</span> of <span><a href="../X509/Distinguished_name/Relative_distinguished_name/index.html#type-t">X509.Distinguished_name.Relative_distinguished_name.t</a> list</span> * <span>[ <span>`ED25519 of Mirage_crypto_ec.Ed25519.pub</span> <span><span>| `P224</span> of Mirage_crypto_ec.P224.Dsa.pub</span> <span><span>| `P256</span> of Mirage_crypto_ec.P256.Dsa.pub</span> <span><span>| `P384</span> of Mirage_crypto_ec.P384.Dsa.pub</span> <span><span>| `P521</span> of Mirage_crypto_ec.P521.Dsa.pub</span> <span><span>| `RSA</span> of Mirage_crypto_pk.Rsa.pub</span> ]</span></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-raw_cert_hack"><a href="#val-raw_cert_hack" class="anchor"></a><code><span class="keyword">val</span> raw_cert_hack : Cstruct.t <span>&#45;&gt;</span> Cstruct.t</code></dt><dt class="spec value" id="val-validate_signature"><a href="#val-validate_signature" class="anchor"></a><code><span class="keyword">val</span> validate_signature : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`Bad_signature of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-validate_time"><a href="#val-validate_time" class="anchor"></a><code><span class="keyword">val</span> validate_time : <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-version_matches_extensions"><a href="#val-version_matches_extensions" class="anchor"></a><code><span class="keyword">val</span> version_matches_extensions : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_path_len"><a href="#val-validate_path_len" class="anchor"></a><code><span class="keyword">val</span> validate_path_len : int <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_ca_extensions"><a href="#val-validate_ca_extensions" class="anchor"></a><code><span class="keyword">val</span> validate_ca_extensions : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_server_extensions"><a href="#val-validate_server_extensions" class="anchor"></a><code><span class="keyword">val</span> validate_server_extensions : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-valid_trust_anchor_extensions"><a href="#val-valid_trust_anchor_extensions" class="anchor"></a><code><span class="keyword">val</span> valid_trust_anchor_extensions : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-ext_authority_matches_subject"><a href="#val-ext_authority_matches_subject" class="anchor"></a><code><span class="keyword">val</span> ext_authority_matches_subject : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-build_paths"><a href="#val-build_paths" class="anchor"></a><code><span class="keyword">val</span> build_paths : <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> list</span></code></dt></dl><dl><dt class="spec type" id="type-ca_error"><a href="#type-ca_error" class="anchor"></a><code><span class="keyword">type</span> ca_error</code> = <code>[ </code><table class="variant"><tr id="type-ca_error.signature_error" class="anchored"><td class="def type"><a href="#type-ca_error.signature_error" class="anchor"></a><code>| </code><code><a href="index.html#type-signature_error">signature_error</a></code></td></tr><tr id="type-ca_error.CAIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAIssuerSubjectMismatch" class="anchor"></a><code>| </code><code>`CAIssuerSubjectMismatch <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-ca_error.CAInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidVersion" class="anchor"></a><code>| </code><code>`CAInvalidVersion <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-ca_error.CACertificateExpired" class="anchored"><td class="def constructor"><a href="#type-ca_error.CACertificateExpired" class="anchor"></a><code>| </code><code>`CACertificateExpired <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-ca_error.CAInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidExtensions" class="anchor"></a><code>| </code><code>`CAInvalidExtensions <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_ca_error"><a href="#val-pp_ca_error" class="anchor"></a><code><span class="keyword">val</span> pp_ca_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`Bad_encoding of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string * Cstruct.t</span> <span><span>| `Bad_signature</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `CACertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `CAInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * Mirage_crypto.Hash.hash</span> <span><span>| `Msg</span> of string</span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-leaf_validation_error"><a href="#type-leaf_validation_error" class="anchor"></a><code><span class="keyword">type</span> leaf_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-leaf_validation_error.LeafCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafCertificateExpired" class="anchor"></a><code>| </code><code>`LeafCertificateExpired <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidName" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidName" class="anchor"></a><code>| </code><code>`LeafInvalidName <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidVersion" class="anchor"></a><code>| </code><code>`LeafInvalidVersion <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidExtensions" class="anchor"></a><code>| </code><code>`LeafInvalidExtensions <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_leaf_validation_error"><a href="#val-pp_leaf_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_leaf_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`LeafCertificateExpired of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span class="type-var">'a</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-chain_validation_error"><a href="#type-chain_validation_error" class="anchor"></a><code><span class="keyword">type</span> chain_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-chain_validation_error.IntermediateInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidExtensions" class="anchor"></a><code>| </code><code>`IntermediateInvalidExtensions <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.IntermediateCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateCertificateExpired" class="anchor"></a><code>| </code><code>`IntermediateCertificateExpired <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-chain_validation_error.IntermediateInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidVersion" class="anchor"></a><code>| </code><code>`IntermediateInvalidVersion <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchor"></a><code>| </code><code>`ChainIssuerSubjectMismatch <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchor"></a><code>| </code><code>`ChainAuthorityKeyIdSubjectKeyIdMismatch <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainInvalidPathlen" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainInvalidPathlen" class="anchor"></a><code>| </code><code>`ChainInvalidPathlen <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</code></td></tr><tr id="type-chain_validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.EmptyCertificateChain" class="anchor"></a><code>| </code><code>`EmptyCertificateChain</code></td></tr><tr id="type-chain_validation_error.NoTrustAnchor" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.NoTrustAnchor" class="anchor"></a><code>| </code><code>`NoTrustAnchor <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.Revoked" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.Revoked" class="anchor"></a><code>| </code><code>`Revoked <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_chain_validation_error"><a href="#val-pp_chain_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_chain_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`ChainAuthorityKeyIdSubjectKeyIdMismatch of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-chain_error"><a href="#type-chain_error" class="anchor"></a><code><span class="keyword">type</span> chain_error</code> = <code>[ </code><table class="variant"><tr id="type-chain_error.signature_error" class="anchored"><td class="def type"><a href="#type-chain_error.signature_error" class="anchor"></a><code>| </code><code><a href="index.html#type-signature_error">signature_error</a></code></td></tr><tr id="type-chain_error.leaf_validation_error" class="anchored"><td class="def type"><a href="#type-chain_error.leaf_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-chain_error.chain_validation_error" class="anchored"><td class="def type"><a href="#type-chain_error.chain_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-chain_validation_error">chain_validation_error</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_chain_error"><a href="#val-pp_chain_error" class="anchor"></a><code><span class="keyword">val</span> pp_chain_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`Bad_encoding of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string * Cstruct.t</span> <span><span>| `Bad_signature</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `ChainAuthorityKeyIdSubjectKeyIdMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * Mirage_crypto.Hash.hash</span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Msg</span> of string</span> <span><span>| `NoTrustAnchor</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-fingerprint_validation_error"><a href="#type-fingerprint_validation_error" class="anchor"></a><code><span class="keyword">type</span> fingerprint_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-fingerprint_validation_error.ServerNameNotPresent" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.ServerNameNotPresent" class="anchor"></a><code>| </code><code>`ServerNameNotPresent <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></code></td></tr><tr id="type-fingerprint_validation_error.NameNotInList" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.NameNotInList" class="anchor"></a><code>| </code><code>`NameNotInList <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></code></td></tr><tr id="type-fingerprint_validation_error.InvalidFingerprint" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.InvalidFingerprint" class="anchor"></a><code>| </code><code>`InvalidFingerprint <span class="keyword">of</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_fingerprint_validation_error"><a href="#val-pp_fingerprint_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_fingerprint_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`InvalidFingerprint of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `NameNotInList</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span class="type-var">'a</span> Domain_name.t</span></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-validation_error"><a href="#type-validation_error" class="anchor"></a><code><span class="keyword">type</span> validation_error</code> = <code>[ </code><table class="variant"><tr id="type-validation_error.signature_error" class="anchored"><td class="def type"><a href="#type-validation_error.signature_error" class="anchor"></a><code>| </code><code><a href="index.html#type-signature_error">signature_error</a></code></td></tr><tr id="type-validation_error.leaf_validation_error" class="anchored"><td class="def type"><a href="#type-validation_error.leaf_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-validation_error.fingerprint_validation_error" class="anchored"><td class="def type"><a href="#type-validation_error.fingerprint_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-fingerprint_validation_error">fingerprint_validation_error</a></code></td></tr><tr id="type-validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.EmptyCertificateChain" class="anchor"></a><code>| </code><code>`EmptyCertificateChain</code></td></tr><tr id="type-validation_error.InvalidChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.InvalidChain" class="anchor"></a><code>| </code><code>`InvalidChain</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_validation_error"><a href="#val-pp_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_validation_error : Stdlib.Format.formatter <span>&#45;&gt;</span> <span>[&lt; <span>`Bad_encoding of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string * Cstruct.t</span> <span><span>| `Bad_signature</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span>| `EmptyCertificateChain</span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * Mirage_crypto.Hash.hash</span> <span>| `InvalidChain</span> <span><span>| `InvalidFingerprint</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Msg</span> of string</span> <span><span>| `NameNotInList</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-r"><a href="#type-r" class="anchor"></a><code><span class="keyword">type</span> r</code><code> = <span><span>(<span><span>(<span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a>)</span> option</span>, <a href="index.html#type-validation_error">validation_error</a>)</span> Stdlib.result</span></code></dt></dl><dl><dt class="spec value" id="val-is_cert_valid"><a href="#val-is_cert_valid" class="anchor"></a><code><span class="keyword">val</span> is_cert_valid : <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`IntermediateCertificateExpired of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-is_ca_cert_valid"><a href="#val-is_ca_cert_valid" class="anchor"></a><code><span class="keyword">val</span> is_ca_cert_valid : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`Bad_signature of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `CACertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `CAInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-valid_ca"><a href="#val-valid_ca" class="anchor"></a><code><span class="keyword">val</span> valid_ca : <span>?&#8288;allowed_hashes:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`Bad_signature of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `CACertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `CAInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `CAIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-is_server_cert_valid"><a href="#val-is_server_cert_valid" class="anchor"></a><code><span class="keyword">val</span> is_server_cert_valid : <span><span><span>[ `host ]</span> Domain_name.t</span> option</span> <span>&#45;&gt;</span> <span>Ptime.t option</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`LeafCertificateExpired of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-signs"><a href="#val-signs" class="anchor"></a><code><span class="keyword">val</span> signs : <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <span>`Bad_signature of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `ChainAuthorityKeyIdSubjectKeyIdMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-issuer"><a href="#val-issuer" class="anchor"></a><code><span class="keyword">val</span> issuer : <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></code></dt><dt class="spec value" id="val-validate_anchors"><a href="#val-validate_anchors" class="anchor"></a><code><span class="keyword">val</span> validate_anchors : <span>(<span>issuer:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a>, <span>[&gt; <span>`NoTrustAnchor of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-verify_single_chain"><a href="#val-verify_single_chain" class="anchor"></a><code><span class="keyword">val</span> verify_single_chain : <span>Ptime.t option</span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a>, <span>[&gt; <span>`Bad_signature of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `ChainAuthorityKeyIdSubjectKeyIdMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-verify_chain"><a href="#val-verify_chain" class="anchor"></a><code><span class="keyword">val</span> verify_chain : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;allowed_hashes:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>anchors:<span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a>, <span>[&gt; <span>`Bad_signature of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `ChainAuthorityKeyIdSubjectKeyIdMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ChainInvalidPathlen</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * int</span> <span><span>| `ChainIssuerSubjectMismatch</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>| `EmptyCertificateChain</span> <span><span>| `Hash_not_allowed</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span></span> <span><span>| `IntermediateCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `IntermediateInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `IntermediateInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `NoTrustAnchor</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Revoked</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `Unsupported_algorithm</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * string</span> <span><span>| `Unsupported_keytype</span> of <a href="../X509/Distinguished_name/index.html#type-t">X509.Distinguished_name.t</a> * <a href="../X509/Public_key/index.html#type-t">X509.Public_key.t</a></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-any_m"><a href="#val-any_m" class="anchor"></a><code><span class="keyword">val</span> any_m : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'b</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'c</span>, <span class="type-var">'d</span>)</span> Stdlib.result</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> list</span> <span>&#45;&gt;</span> <span><span>(<span><span>(<span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> option</span>, <span class="type-var">'a</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-verify_chain_of_trust"><a href="#val-verify_chain_of_trust" class="anchor"></a><code><span class="keyword">val</span> verify_chain_of_trust : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;allowed_hashes:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>anchors:<span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span>(<span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> * <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a>)</span> option</span>, <span>[&gt; `EmptyCertificateChain <span>| `InvalidChain</span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidExtensions</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `LeafInvalidVersion</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> ]</span>)</span> Result.result</span></code></dt><dt class="spec value" id="val-valid_cas"><a href="#val-valid_cas" class="anchor"></a><code><span class="keyword">val</span> valid_cas : <span>?&#8288;allowed_hashes:<span><span>[&gt; `MD5 <span>| `SHA1</span> <span>| `SHA224</span> <span>| `SHA256</span> <span>| `SHA384</span> <span>| `SHA512</span> ]</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span></code></dt><dt class="spec value" id="val-fingerprint_verification"><a href="#val-fingerprint_verification" class="anchor"></a><code><span class="keyword">val</span> fingerprint_verification : <span><span><span>[ `host ]</span> Domain_name.t</span> option</span> <span>&#45;&gt;</span> <span>Ptime.t option</span> <span>&#45;&gt;</span> <span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span> <span>&#45;&gt;</span> <span>(<a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> <span>&#45;&gt;</span> Cstruct.t)</span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> option</span>, <span>[&gt; `EmptyCertificateChain <span><span>| `InvalidFingerprint</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Cstruct.t * Cstruct.t</span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `NameNotInList</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-trust_key_fingerprint"><a href="#val-trust_key_fingerprint" class="anchor"></a><code><span class="keyword">val</span> trust_key_fingerprint : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>hash:<span>[&lt; Mirage_crypto.Hash.hash SHA256 ]</span></span> <span>&#45;&gt;</span> <span>fingerprints:<span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span></span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> option</span>, <span>[&gt; `EmptyCertificateChain <span><span>| `InvalidFingerprint</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Mirage_crypto.Hash.digest * Cstruct.t</span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `NameNotInList</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> ]</span>)</span> Stdlib.result</span></code></dt><dt class="spec value" id="val-trust_cert_fingerprint"><a href="#val-trust_cert_fingerprint" class="anchor"></a><code><span class="keyword">val</span> trust_cert_fingerprint : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>hash:<span>[&lt; Mirage_crypto.Hash.hash ]</span></span> <span>&#45;&gt;</span> <span>fingerprints:<span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span></span> <span>&#45;&gt;</span> <span><a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> option</span>, <span>[&gt; `EmptyCertificateChain <span><span>| `InvalidFingerprint</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * Mirage_crypto.Hash.digest * Cstruct.t</span> <span><span>| `LeafCertificateExpired</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span>Ptime.t option</span></span> <span><span>| `LeafInvalidName</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span><span>| `NameNotInList</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a></span> <span><span>| `ServerNameNotPresent</span> of <a href="../X509/Certificate/index.html#type-t">X509.Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></span> ]</span>)</span> Stdlib.result</span></code></dt></dl></div></body></html>